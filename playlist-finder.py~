# shows a user's playlists (need to be authenticated via oauth)

import sys
import os
import spotipy
import spotipy.util as util

artist_list=[]
def show_artist(results):
    before_artist='null'
    for i, item in enumerate(tracks['items']):
        track = item['track']
	now_artist= track['artists'][0]['name']
	#artist_list.extend(track['artists'][0]['uri'])
	if now_artist != before_artist:	#getting one artist only
	    artist_list.append(now_artist)
	    
	    #gettrack(alink)
	    before_artist = now_artist
	else:
		taco = 1	#temp fix
#artist_list

if __name__ == '__main__':
    if len(sys.argv) > 1:
        username = sys.argv[1]
    else:
        print("Whoops, need your username!")
        print("usage: python user_playlists.py [username]")
        sys.exit()

    token = util.prompt_for_user_token(username)

    if token:
        top = 40
        sp = spotipy.Spotify(auth=token)
        results = sp.user_playlists(username)
        playlists= results['items']
	while results['next']:	#collecting all artists
    	    results = sp.next(results)
    	    playlists.extend(results['items'])
	
	for playlist in playlists:
            if playlist['owner']['id'] == username:
                
                stuff = sp.user_playlist(username, playlist['id'], fields="tracks,next")
                tracks = stuff['tracks']
                show_artist(tracks)
		print artist_list
    else:
        print("Can't get token for", username)


